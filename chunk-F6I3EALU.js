import{C as n,e as d,k as p,ma as T,n as u,na as k}from"./chunk-TQI6H6BR.js";var m=class a{transform(t){return{low:"Baja",medium:"Media",high:"Alta"}[t]||t}static \u0275fac=function(e){return new(e||a)};static \u0275pipe=n({name:"priority",type:a,pure:!0})};var l=class a{transform(t){return{pending:"Pendiente","in-progress":"En progreso",completed:"Completada"}[t]||t}static \u0275fac=function(e){return new(e||a)};static \u0275pipe=n({name:"status",type:a,pure:!0})};var S=class a{constructor(t,e){this.storageService=t;this.authService=e;this.authService.currentUser$.subscribe(r=>{r?this.loadTasks(r.id):this.tasksSubject.next([])})}tasksSubject=new d([]);tasks$=this.tasksSubject.asObservable();loadTasks(t){let e=this.storageService.getTasksByUser(t);this.tasksSubject.next(e)}createTask(t,e,r,s){let i=this.authService.getCurrentUser();if(!i)return null;let o={id:this.generateId(),userId:i.id,title:t,description:e,dueDate:r,priority:s,status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.storageService.saveTask(o),this.loadTasks(i.id),o}updateTask(t){let e=this.authService.getCurrentUser();!e||t.userId!==e.id||(t.updatedAt=new Date().toISOString(),this.storageService.updateTask(t),this.loadTasks(e.id))}deleteTask(t){let e=this.authService.getCurrentUser();e&&(this.storageService.deleteTask(t),this.loadTasks(e.id))}changeTaskStatus(t,e){let s=this.tasksSubject.value.find(i=>i.id===t);s&&(s.status=e,s.updatedAt=new Date().toISOString(),this.updateTask(s))}getTasks(){return this.tasksSubject.value}getTasksByStatus(t){return this.tasksSubject.value.filter(e=>e.status===t)}filterTasksByText(t,e){if(!e.trim())return t;let r=e.toLowerCase();return t.filter(s=>s.title.toLowerCase().includes(r)||s.description&&s.description.toLowerCase().includes(r))}filterTasksByPriority(t,e){return e==="all"?t:t.filter(r=>r.priority===e)}sortTasksByDueDate(t,e=!0){return[...t].sort((r,s)=>{if(!r.dueDate&&!s.dueDate)return 0;if(!r.dueDate)return 1;if(!s.dueDate)return-1;let i=new Date(r.dueDate).getTime(),o=new Date(s.dueDate).getTime();return e?i-o:o-i})}sortTasksByPriority(t,e=!0){let r={low:1,medium:2,high:3};return[...t].sort((s,i)=>{let o=r[s.priority],c=r[i.priority];return e?o-c:c-o})}isTaskOverdue(t){return!t.dueDate||t.status==="completed"?!1:new Date(t.dueDate)<new Date}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}static \u0275fac=function(e){return new(e||a)(u(T),u(k))};static \u0275prov=p({token:a,factory:a.\u0275fac,providedIn:"root"})};export{m as a,l as b,S as c};
