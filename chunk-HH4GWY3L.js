import{a as L,b as u,c as N,d as _,f as R,g as q,h as A,l as j,n as D}from"./chunk-OXF3IH4Y.js";import{a as M}from"./chunk-KJYKEEK3.js";import{E as p,H as l,I as g,J as o,K as n,L as f,N as S,O as v,P as a,R as d,c as h,ea as x,fa as E,ha as y,ja as F,ka as w,ma as I,na as C,w as r,y as m,z as b}from"./chunk-TQI6H6BR.js";function U(s,i){if(s&1&&(o(0,"p",14),a(1),n()),s&2){let e=v();r(),d(" ",e.getErrorMessage("email")," ")}}function B(s,i){if(s&1&&(o(0,"p",14),a(1),n()),s&2){let e=v();r(),d(" ",e.getErrorMessage("password")," ")}}var G=class s{constructor(i,e,t,c,P,k){this.fb=i;this.authService=e;this.storageService=t;this.router=c;this.route=P;this.notificationService=k}loginForm;isLoading=!1;hasUsers=!1;ngOnInit(){if(this.authService.isAuthenticated()){this.router.navigate(["/dashboard"]);return}let i=this.storageService.getUsers();if(this.hasUsers=i.length>0,!this.hasUsers){this.router.navigate(["/register"]);return}this.initForm()}initForm(){this.loginForm=this.fb.group({email:["",[u.required,u.email]],password:["",[u.required,u.minLength(6)]]})}onSubmit(){return h(this,null,function*(){if(this.loginForm.valid){this.isLoading=!0;let{email:i,password:e}=this.loginForm.value,t=yield this.authService.login(i,e);if(t.success){this.notificationService.success("\xA1Bienvenido de nuevo!");let c=this.route.snapshot.queryParams.returnUrl||"/dashboard";this.router.navigate([c])}else this.notificationService.error(t.message);this.isLoading=!1}})}hasError(i){let e=this.loginForm.get(i);return!!(e&&e.invalid&&(e.dirty||e.touched))}getErrorMessage(i){let e=this.loginForm.get(i);return e?.hasError("required")?"Este campo es requerido":e?.hasError("email")?"Email inv\xE1lido":e?.hasError("minlength")?"La contrase\xF1a debe tener al menos 6 caracteres":""}static \u0275fac=function(e){return new(e||s)(m(j),m(C),m(I),m(F),m(y),m(M))};static \u0275cmp=b({type:s,selectors:[["app-login"]],decls:21,vars:9,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-blue-50","to-indigo-100","px-4"],[1,"bg-white","rounded-lg","shadow-xl","p-8","w-full","max-w-md"],[1,"text-3xl","font-bold","text-center","mb-6","text-gray-800"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","email",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","email","type","email","formControlName","email","placeholder","Enter email","aria-required","true",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["class","mt-1 text-sm text-red-600",4,"ngIf"],[1,"mb-6"],["for","password",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","password","type","password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","aria-required","true",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","submit",1,"w-full","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","mb-4",3,"disabled"],[1,"text-center","text-sm","text-gray-600"],["routerLink","/register",1,"text-blue-600","hover:text-blue-800","font-medium"],[1,"mt-1","text-sm","text-red-600"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Iniciar Sesi\xF3n"),n(),o(4,"form",3),S("ngSubmit",function(){return t.onSubmit()}),o(5,"div",4)(6,"label",5),a(7," Email "),n(),f(8,"input",6),p(9,U,2,1,"p",7),n(),o(10,"div",8)(11,"label",9),a(12," Contrase\xF1a "),n(),f(13,"input",10),p(14,B,2,1,"p",7),n(),o(15,"button",11),a(16),n()(),o(17,"p",12),a(18," \xBFNo tienes una cuenta? "),o(19,"a",13),a(20," Reg\xEDstrate aqu\xED "),n()()()()),e&2&&(r(4),l("formGroup",t.loginForm),r(4),g("border-red-500",t.hasError("email")),r(),l("ngIf",t.hasError("email")),r(4),g("border-red-500",t.hasError("password")),r(),l("ngIf",t.hasError("password")),r(),l("disabled",t.loginForm.invalid||t.isLoading),r(),d(" ",t.isLoading?"Iniciando sesi\xF3n...":"Iniciar Sesi\xF3n"," "))},dependencies:[E,x,D,R,L,N,_,q,A,w],encapsulation:2})};export{G as LoginComponent};
