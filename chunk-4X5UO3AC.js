import{a as R,b as l,c as P,d as N,f as M,g as q,h as A,l as L,n as T}from"./chunk-OXF3IH4Y.js";import{a as j}from"./chunk-KJYKEEK3.js";import{E as d,H as m,I as c,J as a,K as o,L as p,N as S,O as b,P as s,R as f,c as v,ea as E,fa as w,ha as y,ja as C,ka as F,ma as _,na as I,w as n,y as u,z as x}from"./chunk-TQI6H6BR.js";function D(r,e){if(r&1&&(a(0,"p",18),s(1),o()),r&2){let t=b();n(),f(" ",t.getErrorMessage("name")," ")}}function U(r,e){if(r&1&&(a(0,"p",18),s(1),o()),r&2){let t=b();n(),f(" ",t.getErrorMessage("email")," ")}}function G(r,e){if(r&1&&(a(0,"p",18),s(1),o()),r&2){let t=b();n(),f(" ",t.getErrorMessage("password")," ")}}function V(r,e){r&1&&(a(0,"p",18),s(1," Las contrase\xF1as no coinciden "),o())}function B(r,e){r&1&&(a(0,"p",19),s(1," \xBFYa tienes una cuenta? "),a(2,"a",20),s(3," Inicia sesi\xF3n aqu\xED "),o()())}function O(r,e){r&1&&(a(0,"p",21),s(1," \u{1F389} \xA1Ser\xE1s el primer usuario! Crea tu cuenta para comenzar. "),o())}function z(r){let e=r.get("password"),t=r.get("confirmPassword");return!e||!t||e.value===t.value?null:{passwordMismatch:!0}}var k=class r{constructor(e,t,i,g,h,Y){this.fb=e;this.authService=t;this.storageService=i;this.router=g;this.route=h;this.notificationService=Y;this.initForm()}registerForm;isLoading=!1;hasUsers=!1;ngOnInit(){if(this.authService.isAuthenticated()){this.router.navigate(["/dashboard"]);return}let e=this.storageService.getUsers();this.hasUsers=e.length>0}initForm(){this.registerForm=this.fb.group({name:["",[l.required,l.minLength(3)]],email:["",[l.required,l.email]],password:["",[l.required,l.minLength(6)]],confirmPassword:["",[l.required]]},{validators:z})}onSubmit(){return v(this,null,function*(){if(Object.keys(this.registerForm.controls).forEach(e=>{this.registerForm.get(e)?.markAsTouched()}),this.registerForm.valid){this.isLoading=!0;let{name:e,email:t,password:i}=this.registerForm.value,g=yield this.authService.register(e,t,i);if(g.success){this.notificationService.success("\xA1Registro exitoso! Bienvenido.");let h=this.route.snapshot.queryParams.returnUrl||"/dashboard";this.router.navigate([h])}else this.notificationService.error(g.message);this.isLoading=!1}else this.notificationService.warning("Por favor, completa todos los campos correctamente.")})}hasError(e){let t=this.registerForm.get(e);return!!(t&&t.invalid&&(t.dirty||t.touched))}getErrorMessage(e){let t=this.registerForm.get(e);return t?.hasError("required")?"Este campo es requerido":t?.hasError("email")?"Email inv\xE1lido":t?.hasError("minlength")?e==="name"?"El nombre debe tener al menos 3 caracteres":"La contrase\xF1a debe tener al menos 6 caracteres":""}hasPasswordMismatch(){let e=this.registerForm.get("confirmPassword");return this.registerForm.hasError("passwordMismatch")&&(!!e?.dirty||!!e?.touched)}static \u0275fac=function(t){return new(t||r)(u(L),u(I),u(_),u(C),u(y),u(j))};static \u0275cmp=x({type:r,selectors:[["app-register"]],decls:29,vars:17,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-blue-50","to-indigo-100","px-4"],[1,"bg-white","rounded-lg","shadow-xl","p-8","w-full","max-w-md"],[1,"text-3xl","font-bold","text-center","mb-6","text-gray-800"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","name","type","text","formControlName","name","placeholder","Tu nombre","aria-required","true",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["class","mt-1 text-sm text-red-600",4,"ngIf"],["for","email",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","email","type","email","formControlName","email","placeholder","tu@email.com","aria-required","true",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["for","password",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","password","type","password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","aria-required","true",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"mb-6"],["for","confirmPassword",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","confirmPassword","type","password","formControlName","confirmPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","aria-required","true",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","submit",1,"w-full","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","mb-4",3,"disabled"],["class","text-center text-sm text-gray-600",4,"ngIf"],["class","text-center text-sm text-blue-600 font-medium mt-4",4,"ngIf"],[1,"mt-1","text-sm","text-red-600"],[1,"text-center","text-sm","text-gray-600"],["routerLink","/login",1,"text-blue-600","hover:text-blue-800","font-medium"],[1,"text-center","text-sm","text-blue-600","font-medium","mt-4"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"Crear Cuenta"),o(),a(4,"form",3),S("ngSubmit",function(){return i.onSubmit()}),a(5,"div",4)(6,"label",5),s(7," Nombre "),o(),p(8,"input",6),d(9,D,2,1,"p",7),o(),a(10,"div",4)(11,"label",8),s(12," Email "),o(),p(13,"input",9),d(14,U,2,1,"p",7),o(),a(15,"div",4)(16,"label",10),s(17," Contrase\xF1a "),o(),p(18,"input",11),d(19,G,2,1,"p",7),o(),a(20,"div",12)(21,"label",13),s(22," Confirmar Contrase\xF1a "),o(),p(23,"input",14),d(24,V,2,0,"p",7),o(),a(25,"button",15),s(26),o()(),d(27,B,4,0,"p",16)(28,O,2,0,"p",17),o()()),t&2&&(n(4),m("formGroup",i.registerForm),n(4),c("border-red-500",i.hasError("name")),n(),m("ngIf",i.hasError("name")),n(4),c("border-red-500",i.hasError("email")),n(),m("ngIf",i.hasError("email")),n(4),c("border-red-500",i.hasError("password")),n(),m("ngIf",i.hasError("password")),n(4),c("border-red-500",i.hasPasswordMismatch()),n(),m("ngIf",i.hasPasswordMismatch()),n(),m("disabled",i.registerForm.invalid||i.isLoading),n(),f(" ",i.isLoading?"Registrando...":"Registrarse"," "),n(),m("ngIf",i.hasUsers),n(),m("ngIf",!i.hasUsers))},dependencies:[w,E,T,M,R,P,N,q,A,F],encapsulation:2})};export{k as RegisterComponent};
